% ----- Default Font ----- %

\settextfont[Path=./Fonts/,
    BoldFont={XB Yas Bd},
    ItalicFont={XB Yas It},
    BoldItalicFont={XB Yas BdIt},
    Extension = .ttf]{XB Yas}

% ----- Costume Font ----- %

\defpersianfont\BTitr[Path=./Fonts/, Extension = .ttf]{BTitr}
\defpersianfont\BNazanin[Path=./Fonts/, Extension = .ttf]{BNAZANIN}

% ----- Points ----- %

\newcounter{point}[chapter]\setcounter{point}{0}
%\renewcommand{\thepoint}{\arabic{chapter}.\arabic{point}}
%\newenvironment{name}[args]{begin_def}{end_def}

\newenvironment{point}[2][]{%
    \refstepcounter{point}%
    \ifstrempty{#1}%
    {\mdfsetup{%
        frametitle={%
        \tikz[baseline=(current bounding box.east),outer sep=0pt]
        \node[anchor=east,rectangle,fill=blue!30]
        {\strut نکته~};}}
    }%
    {\mdfsetup{%
        frametitle={%
        \tikz[baseline=(current bounding box.east),outer sep=0pt]
        \node[anchor=east,rectangle,fill=blue!30]
        {\Large \strut نکته~};}}%
    }%
    \mdfsetup{innertopmargin=10pt,linecolor=blue!30,%
        linewidth=2pt,topline=true,%
        frametitleaboveskip=\dimexpr-\ht\strutbox\relax
    }
    \begin{mdframed}[]
        \relax%
        \label{#2}}{
    \end{mdframed}
}

% ----- Equation ----- %

\newcounter{eqtn}[chapter]\setcounter{eqtn}{0}
\renewcommand{\theequ}{\arabic{eqtn}.\arabic{chapter}}

\newenvironment{eqtn}[2][]{
    \refstepcounter{eqtn}
    \ifstrempty{#1}
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=green!40]
            {\strut معادله~\theequ};
        }
    }
    }
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=green!40]
            {\strut معادله~\theequ:~#1};
        }
    }
    }
    \mdfsetup{innertopmargin=10pt,linecolor=green!40,
        linewidth=2pt,topline=true,
        frametitleaboveskip=\dimexpr-\ht\strutbox\relax
    }
    \begin{mdframed}[]
        \relax
        \label{#2}}{
    \end{mdframed}
}

% ----- Examples ----- %

\newcounter{example}[chapter]\setcounter{example}{0}
\renewcommand{\theexmp}{\arabic{example}.\arabic{chapter}}

\newenvironment{example}[2][]{
    \refstepcounter{example}
    \ifstrempty{#1}
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=red!30]
            {\strut مثال~\theexmp};
        }
    }
    }
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=red!30]
            {\strut مثال~\theexmp:~#1};
        }
    }
    }
    \mdfsetup{innertopmargin=10pt,linecolor=red!30,
        linewidth=2pt,topline=true,
        frametitleaboveskip=\dimexpr-\ht\strutbox\relax
    }
    \begin{mdframed}[]
        \relax
        \label{#2}}{
    \end{mdframed}}

% ----- Hints ----- %

\newcounter{hint}[chapter]\setcounter{hint}{0}
\renewcommand{\thehnt}{\arabic{hint}.\arabic{chapter}}

\newenvironment{hint}[2][]{
    \refstepcounter{hint}
    \ifstrempty{#1}
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=black!30]
            {\strut راهنمایی~};
        }
    }
    }
    {\mdfsetup{
        frametitle={
            \tikz[baseline=(current bounding box.east),outer sep=0pt]
            \node[anchor=east,rectangle,fill=black!30]
            {\strut راهنمایی~};
        }
    }
    }
    \mdfsetup{innertopmargin=10pt,linecolor=black!30,
        linewidth=2pt,topline=true,
        frametitleaboveskip=\dimexpr-\ht\strutbox\relax
    }
    \begin{mdframed}[]
        \relax
        \label{#2}}{
    \end{mdframed}}

% ----- Costume Title ----- %

\newcommand*\rullCenterTextWithLine[1]{\par\noindent\raisebox{.8ex}{\makebox[\linewidth]{\hrulefill\hspace{1ex}\raisebox{-.8ex}{#1}\hspace{1ex}\hrulefill}}}
\newcommand{\rullFillWithLine}[2][0em]{\leaders\hbox{\rule[#1]{1pt}{#2}}\hfill}

% ----- Colors ----- %

\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{mygray}{rgb}{0.9,0.9,0.9}
\definecolor{myCyan}{rgb}{0,1,1}
\definecolor{navyBlue}{HTML}{0a065d}
\definecolor{myGreen}{HTML}{A7F432}
\definecolor{aliceblue}{rgb}{0.94, 0.97, 1.0}

% ----- Other Commands ----- %

\setminted{
    frame=lines,
    framesep=2mm,
    baselinestretch=1.0,
    xrightmargin=0in,
    xleftmargin=0in,
    fontsize=\footnotesize,
    bgcolor=aliceblue,
    linenos=true
}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=blue,
}
\setlist[enumerate]{itemsep=-3mm}
\setlist[itemize]{itemsep=-3mm}

\newfloat{program}{thp}{lop}
\floatname{program}{نمونه کد}
\newcommand{\programref}[1]{نمونه کد \ref{#1}}

%\renewcommand{\chaptername}{جلسه}
%\renewcommand{\baselinestretch}{1.5}
\newcommand{\grayBox}[1]{\colorbox{gray!10}{\lr{\texttt{#1}}}}
\newcommand{\grayLBox}[1]{\fbox{\grayBox{\parbox{11.8 cm}{#1}}}}

\AtBeginEnvironment{minted}{\setlength{\parskip}{-20pt}}
\xpretocmd{\inputminted}{\par\vspace{-10pt}}{}{}
\xapptocmd{\inputminted}{\par\vspace{-20pt}}{}{}

\makeatletter
\newcommand{\chapterauthor}[1]{%
        {\parindent0pt\vspace*{-25pt}%
    \linespread{1.1}\large\scshape#1%
    \par\nobreak\vspace*{35pt}}
    \@afterheading%
}
\makeatother


%---- Programs ----%

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\normalsize\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\normalsize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    captiondirection=RTL,
    fontadjust=true
}

\lstset{columns=fullflexible, xleftmargin=0.5cm, frame=tlbr, framesep=4pt, framerule=0pt}
\lstset{style=mystyle}

% ---- Else ---- %

\def\lstlistingname{Code}

\renewcommand{\thefigure}{\arabic{figure}.\arabic{chapter}}
\renewcommand{\thesection}{\arabic{section}.\arabic{chapter}}
\renewcommand{\thesubsection}{\arabic{subsection}.\arabic{section}.\arabic{chapter}}

\newcounter{quest}[chapter]\setcounter{quest}{0}
\renewcommand{\thequest}{\arabic{quest}.\arabic{chapter}}

\chapterfont{\color{white}}
